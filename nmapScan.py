#!/bin/bash
#------------------------------------------
#---Made by:   ./1scriptmaker.sh
#---This is:   nmapScan.py
#------------------------------------------

# Simple scanner
# We were targeting a simple Centos7 VM
# These are simple scans, and should be adjusted greatly towards target.

import nmap
print("\n==========================================")
ns = nmap.PortScanner() # ns - nmap scanner object
# -------------------------------------------------
print("\n==========================================")
print("nmap_version() = ")
print(ns.nmap_version()) # Print version/ports of
# -------------------------------------------------

print("\n==========================================")
# scan,  targetIP,   port-range, verbose
ns_scan = ['10.0.2.15', '1-1000', '-v']
print("ns_scan[0] = "+ns_scan[0])
print("ns_scan[1] = "+ns_scan[1])
print("ns_scan[2] = "+ns_scan[2])
#ns.scan('10.0.2.15', 	'1-1000', 	'-v')
ns.scan(ns_scan[0], 	ns_scan[1], 	ns_scan[2]) # Just to try array input
# Result: {'tcp': {'services': '1-10', 'method': 'syn'}}
# -------------------------------------------------
#
print("\n==========================================")
print("ns.scaninfo() = ")
print(ns.scaninfo())
# -------------------------------------------------
#
print("\n==========================================")
print("ns.csv() ")
print(ns.csv()) 
#Ex. 10.0.2.15;;;tcp;21;ftp;filtered;;;host-prohibited;;3;
#Ex. 10.0.2.15;;;tcp;22;ssh;open;;;syn-ack;;3;
# -------------------------------------------------

print("\n==========================================")
print("Basic scan stats - ns.scanstats()")
print(ns.scanstats())
#Ex. {'uphosts': '1', 'timestr': 'Mon Jan 27 23:47:44 2020', 
#	'downhosts': '0', 'totalhosts': '1', 'elapsed': '1.73'}
# -------------------------------------------------

print("\n==========================================")
print("Current hosts - ns.all_hosts()")
print(ns.all_hosts())
#Ex. ['10.0.2.15']
# -------------------------------------------------

print("\n==========================================")
print("Current State - ns[\'10.0.2.15\'].state() ")
print(ns['10.0.2.15'].state())
#Ex. up
# -------------------------------------------------

print("\n==========================================")
print("Protocols - ns[\'10.0.2.15\'].all_protocols()")
print(ns['10.0.2.15'].all_protocols())
#Ex. ['tcp']
# -------------------------------------------------

print("\n==========================================")
print("Open Ports - ns[\'10.0.2.15\'][\'tcp\'].keys()")
print(ns['10.0.2.15']['tcp'].keys())
#Ex. [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 
#	16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 
#	29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 
#	42, 43, 44, 45, 46, 47, 48, 49, 50]
# -------------------------------------------------

print("\n==========================================")
# Search for a specific port
print("ns['10.0.2.15'].has_tcp(80) = ")
print(ns['10.0.2.15'].has_tcp(80))
# -------------------------------------------------

print("\n==========================================")
# -------------------------------------------------

print("\n==========================================")
# -------------------------------------------------

print("\n==========================================")
# -------------------------------------------------

print("\n==========================================")
# -------------------------------------------------

